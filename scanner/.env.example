# NetSage Scanner Environment Configuration
# =======================================

# Server Configuration
PORT=3001
HOST=localhost
CALLBACK_URL=http://localhost:4000/webhooks/scan-result

# Scanner Timeouts (milliseconds)
# ------------------------------
# Timeout for port scanning operations
PORT_SCAN_TIMEOUT=120000
# Timeout for HTTP analysis operations
HTTP_SCAN_TIMEOUT=60000
# Timeout for Nuclei vulnerability scans
NUCLEI_SCAN_TIMEOUT=300000
# Overall timeout for entire scan process
OVERALL_SCAN_TIMEOUT=600000
# Enable adaptive timeouts based on target response
ADAPTIVE_TIMEOUTS=true

# Proxy Configuration
# -----------------
# Enable proxy support for scanning
ENABLE_PROXY_SUPPORT=true
# Rotate through different user agents for stealth
ROTATE_USER_AGENTS=true
# Enable connection pooling for better performance
ENABLE_CONNECTION_POOLING=true
# Maximum number of connections in the pool
MAX_POOL_SIZE=10
# Timeout for pooled connections (milliseconds)
POOL_TIMEOUT=30000

# Configure your proxy (examples below, uncomment and modify as needed)
# Single HTTP proxy:
# PROXY_LIST='[{"protocol":"http","host":"your-proxy-address.com","port":8080}]'

# HTTP proxy with authentication:
# PROXY_LIST='[{"protocol":"http","host":"your-proxy-address.com","port":8080,"auth":{"username":"your_username","password":"your_password"}}]'

# SOCKS5 proxy:
# PROXY_LIST='[{"protocol":"socks5","host":"your-proxy-address.com","port":1080}]'

# Phase 4, Step 1: Evasion Techniques Configuration
# ------------------------------
# Master switch to enable/disable all evasion techniques
ENABLE_EVASION=true
# Evasion profile: minimal, moderate, aggressive
EVASION_PROFILE=moderate
# Enable IP fragmentation (-f flag in nmap)
ENABLE_FRAGMENTATION=true
# Enable decoy scans (-D parameter)
ENABLE_DECOYS=true
# Enable source port manipulation (--source-port)
ENABLE_SOURCE_PORT=true
# Enable randomized scan order (--randomize-hosts)
ENABLE_RANDOMIZATION=true

# Phase 4, Step 2: Alternative Detection Methods Configuration
# ------------------------------
# Master switch to enable/disable all alternative detection methods
ENABLE_ALTERNATIVE_DETECTION=true
# Enable SSL/TLS certificate analysis
ALTERNATIVE_DETECTION_SSL=true
# Enable HTTP response fingerprinting
ALTERNATIVE_DETECTION_HTTP=true
# Enable JavaScript/CSS technology detection
ALTERNATIVE_DETECTION_JS=true
# Timeout for alternative detection requests (milliseconds)
ALTERNATIVE_DETECTION_TIMEOUT=15000

# Phase 4, Step 3: Proxy Support Configuration
# ------------------------------
# Master switch to enable/disable proxy support
ENABLE_PROXY_SUPPORT=true
# Enable TOR proxy support
ENABLE_TOR=false
# Enable user agent rotation
ROTATE_USER_AGENTS=true
# Enable connection pooling
ENABLE_CONNECTION_POOLING=true
# Maximum connections per proxy pool
MAX_POOL_SIZE=10
# Connection pool timeout (milliseconds)
POOL_TIMEOUT=30000

# Proxy List Configuration
# JSON array of proxy configurations
# Example: [{"protocol":"http","host":"proxy.example.com","port":8080,"auth":{"username":"user","password":"pass"}}]
PROXY_LIST=[]

# TOR Proxy Configuration
# TOR proxy host (default: 127.0.0.1)
TOR_PROXY_HOST=127.0.0.1
# TOR proxy port (default: 9050)
TOR_PROXY_PORT=9050
# TOR proxy protocol (default: socks5)
TOR_PROXY_PROTOCOL=socks5

# Proxy Test Configuration
# URL to test proxy connectivity
PROXY_TEST_URL=http://httpbin.org/ip
# Maximum retries for proxy requests
PROXY_MAX_RETRIES=3
# Retry delay in milliseconds
PROXY_RETRY_DELAY=1000
# Fallback to direct connection if proxies fail
PROXY_FALLBACK_TO_DIRECT=true

# Scan Configuration
# -----------------
# Ports to scan (comma-separated)
DEFAULT_PORTS_TO_SCAN=21,22,25,80,443,3306,8080,8443
# Run aggressive scans with more intensive techniques
AGGRESSIVE_SCAN=false
# Enable Nuclei vulnerability scanning
ENABLE_NUCLEI=true
# Nuclei template categories to use (comma-separated)
NUCLEI_TEMPLATES=technologies,cves,vulnerabilities
# Run comprehensive scan with all templates
COMPREHENSIVE_SCAN=false

# Nuclei Configuration
# -------------------
# Rate limit for Nuclei requests per second
NUCLEI_RATE_LIMIT=150
# Maximum concurrent templates
NUCLEI_CONCURRENCY=25
# Path to Nuclei executable
# NUCLEI_PATH=nuclei

# Output Configuration
# ------------------
# Directory for scan results
RESULTS_DIR=./scan-results

# Debug Settings
# -------------
# Set to 'production' to hide stack traces in errors
NODE_ENV=development
